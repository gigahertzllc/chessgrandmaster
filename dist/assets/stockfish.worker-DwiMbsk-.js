(function(){"use strict";let s=null,n=!1;const a="https://cdnjs.cloudflare.com/ajax/libs/stockfish.js/10.0.2/stockfish.js";function r(e){self.postMessage(e)}async function f(){if(s)return s;try{return importScripts(a),s=STOCKFISH(),s.onmessage=e=>{r({type:"engine_line",line:e})},s}catch(e){throw r({type:"error",message:"Failed to load Stockfish: "+e.message}),e}}function i(e){s&&s.postMessage(e)}function o(e){e&&i(`setoption name Skill Level value ${e.skillLevel??20}`)}self.onmessage=async e=>{const t=e.data;if(t.type==="init"){try{await f(),i("uci"),i("isready"),n=!0,r({type:"ready"})}catch(l){r({type:"error",message:l.message})}return}if(!n){r({type:"error",message:"Engine not ready yet"});return}if(t.type==="set_profile"){o(t.profile),i("isready");return}if(t.type==="analyze"){t.profile&&o(t.profile),i("position fen "+t.fen),i("go movetime "+(t.movetimeMs??200));return}if(t.type==="stop"){i("stop");return}}})();
